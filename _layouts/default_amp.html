{% capture metaDescription %}
    {% if page.excerpt %}
        {{ page.excerpt }}
    {% else %}
        {{ site.description }}
    {% endif %}
{% endcapture %}
{% assign metaDescription = {{metaDescription | normalize_whitespace | strip_html | truncate: 160 | escape}} %}
{% capture metaTitle %}{% if page.title %}{{ page.title | escape }}{% else %}{{ site.title | escape }}{% endif %}{% endcapture %}
{% capture metaImage %}{% if page.splash %}{{ page.splash }}{% else %}{{ site.splash }}{% endif %}{% endcapture %}
{% capture pageURL %}{{ page.url | replace:'index.html','' | absolute_url }}{% endcapture %}
<!-- 
    TODO fix image heights
-->
<!DOCTYPE html>
<html amp lang="{{ page.lang | default: site.lang | default: "en" }}">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
        <script async src="https://cdn.ampproject.org/v0.js"></script>
        <script async custom-element="amp-social-share" src="https://cdn.ampproject.org/v0/amp-social-share-0.1.js"></script>

        <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style><noscript><style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style></noscript>

        <title>{% if page.title %}{{ page.title | escape }}{% else %}{{ site.title | escape }}{% endif %}</title>
        <meta name="description" content="{{ page.excerpt | default: site.description | strip_html | normalize_whitespace | truncate: 160 | escape }}">

        <link rel="canonical" href="{{ page.url | replace:'index.html','' | replace:'amp/','' | absolute_url }}">

        {% if jekyll.environment == 'production' %}
        <style amp-custom>{% include /assets/css/app.min.css %}</style>
        {% else %}
        <link rel="stylesheet" href="/assets/css/app.css">
        {% endif %}

        <link href="https://fonts.googleapis.com/css?family=Open+Sans:400,600,700,800|Lora:400,700" rel="stylesheet">

        <script type="application/ld+json">
        {
          "@context": "http://schema.org",
          "@type": "NewsArticle",
          "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https://google.com/article"
          },
          "headline": "{{metaTitle}}",
          "image": {
            "@type": "ImageObject",
            "url": "{{ metaImage }}",
            "height": 800,
            "width": 800
          },
          "datePublished": "{{ page.iso_date }}",
          "dateModified": "{{ page.iso_date }}",
          "author": {
            "@type": "Person",
            "name": "{{site.author}}"
          },
           "publisher": {
            "@type": "Organization",
            "name": "{{site.title}}",
            "logo": {
              "@type": "ImageObject",
              "url": "{{ site.splash }}",
              "width": 600,
              "height": 60
            }
          },
          "description": "{{metaDescription}}"
        }
        </script>
    </head>

    <body>
        {% include header.html %}

        <main role="main">
            <section class="grid">
                {% include posts_amp.html %}
            </section>
        </main>

        <footer class="grid">
            <div class="footer">
                Pixelart.io
            </div>
        </footer>
    </body>
</html>