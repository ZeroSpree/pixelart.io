$(function(){var $win=$(window),$streamContainer=$("#stream"),paginationPath=$streamContainer.attr("data-pagination-path"),iTreshold=$(".posts-placeholder").height(),processRequest=true,requestPage,paginationRequest,scrollTreshold;$win.scroll(function(){scrollTreshold=$(document).height()-$win.height()-iTreshold;if(scrollTreshold<$win.scrollTop()&&processRequest===true){processRequest=false;requestPage=parseInt($streamContainer.attr("data-pagination-current-page"))+1;paginationRequest="/pagination/"+paginationPath+"/page/"+requestPage+"/index.html";$.ajax({url:paginationRequest,dataType:"html",success:function(data){$streamContainer.append(data).attr("data-pagination-current-page",requestPage);processRequest=true;ga("send",{hitType:"event",eventCategory:"Load More",eventAction:"Load More",eventLabel:"Load more page "+requestPage})},error:function(){$(".posts-placeholder").remove();ga("send",{hitType:"event",eventCategory:"Load More",eventAction:"Load More End",eventLabel:"Load more end page "+requestPage})}})}})});$(function(){$("body").on("click",".js-sharer",function(e){e.preventDefault();var $t=$(this),service=$t.attr("data-service").toLowerCase(),$ct=$t.parents(".posts").first(),title=$ct.find(".js--title").text(),media_url=$ct.attr("data-url"),thumb=$ct.attr("data-splash"),description="Find more pixelart design and inspiration at pixelart.io",caption="PIXELART.IO",share_url="";media_url_encoded=encodeURIComponent(media_url);if(service=="facebook"){share_url="https://www.facebook.com/dialog/feed?app_id=1344412318946948&display=popup&description="+description+"&caption="+caption+"&link="+media_url_encoded+"&redirect_uri="+media_url_encoded+"&picture="+thumb}else if(service=="twitter"){share_url="https://twitter.com/share?url="+media_url_encoded+"&text="+title+"&via=pixelartIO&hashtags=pixelart,inspiration"}else if(service=="google+"){share_url="https://plus.google.com/share?url="+media_url_encoded}else if(service=="tumblr"){share_url="http://tumblr.com/share/link?url="+media_url_encoded+"&content="+thumb+"&posttype=photo&tags=pixelart,inspiration&show-via="+media_url}else if(service=="pinterest"){share_url="http://pinterest.com/pin/create/button/?url="+media_url_encoded+"&description="+title+" found on pixelart.io&media="+thumb}else if(service=="reddit"){share_url="http://www.reddit.com/submit?url="+media_url_encoded+"&title="+title+" found on http://pixelart.io"}if(share_url.length){window.open(share_url,"Sharer","height=500,width=900,top=150,left=150").focus();ga("send",{hitType:"event",eventCategory:"Article Share",eventAction:"Share on "+service,eventLabel:"Shared "+media_url})}})});$(function(){var $win=$(window);$.fn.scrollEnd=function(callback,timeout){$(this).scroll(function(){var $this=$(this);if($this.data("scrollTimeout")){clearTimeout($this.data("scrollTimeout"))}$this.data("scrollTimeout",setTimeout(callback,timeout))})};$win.scrollEnd(function(){$.each($("#stream .posts"),function(){var $t=$(this),url=$t.attr("data-relurl"),urlProcessed=$t.attr("data-url-processed"),tOffsetTop=$t.offset().top,tOffsetBottom=tOffsetTop+$t.outerHeight(),winTop=$win.scrollTop(),winHeight=$win.height(),winBottom=winTop+winHeight,bottomTreshold=winBottom-winHeight/2,topTreshold=winTop+winHeight/2;if(tOffsetTop<bottomTreshold&&tOffsetBottom>topTreshold){history.pushState({},"",url);if(urlProcessed!="true"){$t.attr("data-url-processed",true);ga("send",{hitType:"pageview",page:url})}}})},100)});